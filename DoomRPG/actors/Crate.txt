actor DRPGCrate : SwitchableDecoration
{
    var int user_id;
    
    Radius 16
    Height 8
    
    -SOLID
    +USESPECIAL
    
    Activation THINGSPEC_ThingActs | THINGSPEC_ThingTargets | THINGSPEC_Switch | THINGSPEC_Deactivate
    
    Scale 0.75
    
    States
    {
    Spawn:
        TNT1 A 0 NoDelay ACS_NamedExecuteAlways("InitCrate", 0)
    Spawn2:
        TNT1 A 0 A_PlaySound("crate/loop1", CHAN_AUTO, 0.75, true, 1.25)
        CRAT ABCDEFGHIJKLMNOPQRSTUVWXYZ 2 Bright
        CRA2 ABCDEFGHIJKLMNOPQRSTUVWXYZ 2 Bright
        CRA3 A 2 Bright
        Loop
    Active:
    Inactive:
        TNT1 A 0 ACS_NamedExecuteAlways("UseCrate", 0, user_id)
        Goto Spawn2
    Empty:
        TNT1 A 0 A_StopSound(CHAN_AUTO)
        TNT1 A 0 A_PlaySound("crate/off", CHAN_AUTO, 0.75, false, 1.25)
        TNT1 A 0 A_ChangeFlag("USESPECIAL", false)
        CRA3 B -1
        Stop
    }
}
