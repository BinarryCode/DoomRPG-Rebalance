actor DRPGZombieMan : Zombieman Replaces Zombieman
{
    Tag "Former Human"
    
    States
    {
    Spawn:
        POSS A 0 NoDelay ACS_NamedExecuteAlways("MonsterInit", 0)
        Goto Super::Spawn
    See:
        POSS A 0 ACS_NamedExecuteAlways("MonsterInit", 0)
        Goto Super::See
    }
}

actor DRPGShotgunGuy : ShotgunGuy Replaces ShotgunGuy
{
    Tag "Former Sergeant"
    
    States
    {
    Spawn:
        SPOS A 0 NoDelay ACS_NamedExecuteAlways("MonsterInit", 0)
        Goto Super::Spawn
    See:
        SPOS A 0 ACS_NamedExecuteAlways("MonsterInit", 0)
        Goto Super::See
    }
}

actor DRPGChaingunGuy : ChaingunGuy Replaces ChaingunGuy
{
    Tag "Former Commando"
    
    States
    {
    Spawn:
        CPOS A 0 NoDelay ACS_NamedExecuteAlways("MonsterInit", 0)
        Goto Super::Spawn
    See:
        CPOS A 0 ACS_NamedExecuteAlways("MonsterInit", 0)
        Goto Super::See
    }
}

actor DRPGDoomImp : DoomImp Replaces DoomImp
{
    Tag "Imp"
    
    States
    {
    Spawn:
        TROO A 0 NoDelay ACS_NamedExecuteAlways("MonsterInit", 0)
        Goto Super::Spawn
    See:
        TROO A 0 ACS_NamedExecuteAlways("MonsterInit", 0)
        Goto Super::See
    }
}

actor DRPGDemon : Demon Replaces Demon
{
    Tag "Demon"
    
    States
    {
    Spawn:
        SARG A 0 NoDelay ACS_NamedExecuteAlways("MonsterInit", 0)
        Goto Super::Spawn
    See:
        SARG A 0 ACS_NamedExecuteAlways("MonsterInit", 0)
        Goto Super::See
    }
}

actor DRPGSpectre : Spectre Replaces Spectre
{
    Tag "Spectre"
    
    States
    {
    Spawn:
        SARG A 0 NoDelay ACS_NamedExecuteAlways("MonsterInit", 0)
        Goto Super::Spawn
    See:
        SARG A 0 ACS_NamedExecuteAlways("MonsterInit", 0)
        Goto Super::See
    }
}

actor DRPGCacodemon : Cacodemon Replaces Cacodemon
{
    Tag "Cacodemon"
    
    States
    {
    Spawn:
        HEAD A 0 NoDelay ACS_NamedExecuteAlways("MonsterInit", 0)
        Goto Super::Spawn
    See:
        HEAD A 0 ACS_NamedExecuteAlways("MonsterInit", 0)
        Goto Super::See
    }
}

actor DRPGHellKnight : HellKnight Replaces HellKnight
{
    Tag "Hell Knight"
    
    States
    {
    Spawn:
        BOS2 A 0 NoDelay ACS_NamedExecuteAlways("MonsterInit", 0)
        Goto Super::Spawn
    See:
        BOS2 A 0 ACS_NamedExecuteAlways("MonsterInit", 0)
        Goto Super::See
    }
}

actor DRPGBaronOfHell : BaronOfHell Replaces BaronOfHell
{
    Tag "Baron of Hell"
    
    States
    {
    Spawn:
        BOSS A 0 NoDelay ACS_NamedExecuteAlways("MonsterInit", 0)
        Goto Super::Spawn
    See:
        BOSS A 0 ACS_NamedExecuteAlways("MonsterInit", 0)
        Goto Super::See
    }
}

actor DRPGLostSoul : LostSoul Replaces LostSoul
{
    Tag "Lost Soul"
    
    States
    {
    Spawn:
        SKUL A 0 NoDelay ACS_NamedExecuteAlways("MonsterInit", 0, MF_NOXP | MF_NOAURA | MF_NODROPS)
        Goto Super::Spawn
    See:
        SKUL A 0 ACS_NamedExecuteAlways("MonsterInit", 0, MF_NOXP | MF_NOAURA | MF_NODROPS)
        Goto Super::See
    }
}

actor DRPGPainElemental : PainElemental Replaces PainElemental
{
    Tag "Pain Elemental"
    
    States
    {
    Spawn:
        PAIN A 0 NoDelay ACS_NamedExecuteAlways("MonsterInit", 0)
        Goto Super::Spawn
    See:
        PAIN A 0 ACS_NamedExecuteAlways("MonsterInit", 0)
        Goto Super::See
    }
}

actor DRPGRevenant : Revenant Replaces Revenant
{
    Tag "Revenant"
    
    States
    {
    Spawn:
        SKEL A 0 NoDelay ACS_NamedExecuteAlways("MonsterInit", 0)
        Goto Super::Spawn
    See:
        SKEL A 0 ACS_NamedExecuteAlways("MonsterInit", 0)
        Goto Super::See
    }
}

actor DRPGFatso : Fatso Replaces Fatso
{
    Tag "Mancubus"
    
    States
    {
    Spawn:
        FATT A 0 NoDelay ACS_NamedExecuteAlways("MonsterInit", 0)
        Goto Super::Spawn
    See:
        FATT A 0 ACS_NamedExecuteAlways("MonsterInit", 0)
        Goto Super::See
    }
}

actor DRPGArachnotron : Arachnotron Replaces Arachnotron
{
    Tag "Arachnotron"
    
    States
    {
    Spawn:
        BSPI A 0 NoDelay ACS_NamedExecuteAlways("MonsterInit", 0)
        Goto Super::Spawn
    See:
        BSPI A 0 ACS_NamedExecuteAlways("MonsterInit", 0)
        Goto Super::See
    }
}

actor DRPGArchvile : Archvile Replaces Archvile
{
    Tag "Archvile"
    
    States
    {
    Spawn:
        VILE A 0 NoDelay ACS_NamedExecuteAlways("MonsterInit", 0)
        Goto Super::Spawn
    See:
        VILE A 0 ACS_NamedExecuteAlways("MonsterInit", 0)
        Goto Super::See
    }
}

actor DRPGWolfensteinSS : WolfensteinSS Replaces WolfensteinSS
{
    Tag "Wolfenstein SS"
    
    States
    {
    Spawn:
        SSWV A 0 NoDelay ACS_NamedExecuteAlways("MonsterInit", 0)
        Goto Super::Spawn
    See:
        SSWV A 0 ACS_NamedExecuteAlways("MonsterInit", 0)
        Goto Super::See
    }
}

actor DRPGCyberdemon : Cyberdemon Replaces Cyberdemon
{
    Tag "Cyberdemon"
    
    States
    {
    Spawn:
        CYBR A 0 NoDelay ACS_NamedExecuteAlways("MonsterInit", 0, MF_BOSS)
        Goto Super::Spawn
    See:
        CYBR A 0 ACS_NamedExecuteAlways("MonsterInit", 0, MF_BOSS)
        Goto Super::See
    }
}

actor DRPGSpiderMastermind : SpiderMastermind Replaces SpiderMastermind
{
    Tag "Spider Mastermind"
    
    States
    {
    Spawn:
        SPID A 0 NoDelay ACS_NamedExecuteAlways("MonsterInit", 0, MF_BOSS)
        Goto Super::Spawn
    See:
        SPID A 0 ACS_NamedExecuteAlways("MonsterInit", 0, MF_BOSS)
        Goto Super::See
    }
}

// The Boss Brain needs special handling for the exit script
actor DRPGBossBrain : BossBrain Replaces BossBrain
{
    States
    {
    Spawn:
        BBRN A 0 NoDelay ACS_NamedExecuteAlways("MonsterInit", 0, MF_NOXP | MF_NOSTATS | MF_NOAURA | MF_NOPAYKILL | MF_NODROPS | MF_NOHEALTHBAR)
        Goto Super::Spawn
    Death:
        BBRN A 0 ACS_Execute(30000, 0)
        Goto Super::Death
    }
}

// Practice Target
actor DRPGPracticeTarget 19999
{
    Radius 16
    Height 40
    Health 100000
    Mass 0x7FFFFFFF
    
    Scale 0.25
    
    +ISMONSTER
    +SHOOTABLE
    +NOGRAVITY
    +NOBLOOD
    +FORCEYBILLBOARD
    +NEVERTARGET
    -SOLID
    -COUNTKILL
    
    States
    {
    Spawn:
        TNT1 A 0 NoDelay Bright ACS_NamedExecuteAlways("MonsterInit", 0, MF_NOXP | MF_NOSTATS | MF_NOAURA | MF_NOPAYKILL | MF_NODROPS | MF_NOHEALTHBAR)
    See:
        TRGT A 1
        Loop
    Death:
        TNT1 A -1 A_SpawnItemEx("DRPGPracticeTarget", 0, 0, 0, 0, 0, 0, 0, SXF_NOCHECKPOSITION)
        Stop
    }
}

// Used to buff friendly monsters and give them the appropriate flags
actor DRPGFriendlyBooster : CustomInventory
{
    States
    {
    Pickup:
        TNT1 A 0 A_ChangeFlag("SOLID", false)
        TNT1 A 0 A_ChangeFlag("ALWAYSFAST", true)
        TNT1 A 0 A_ChangeFlag("QUICKTORETALIATE", true)
        TNT1 A 0 A_ChangeFlag("MISSILEMORE", true)
        Stop
    }
}

// Makes enemy more aggressive
actor DRPGAggressionBooster : CustomInventory
{
    States
    {
    Pickup:
        TNT1 A 0 A_ChangeFlag("ALWAYSFAST", true)
        TNT1 A 0 A_ChangeFlag("QUICKTORETALIATE", true)
        Stop
    }
}

// --------------------------------------------------
// CRYSTALS

// Crystal Base
actor DRPGCrystalBase
{
    Radius 8
    Height 24
    
    Health 10000
    Speed 10
    FloatSpeed 10
    
    RenderStyle Add
    
    Monster
    +FLOAT
    +FLOATBOB
    +NOGRAVITY
    +NOBLOOD
    +BRIGHT
    +BOSS
    -COUNTKILL
    
    States
    {
    Spawn:
        CRYS ABCD 4
        Loop
    }
}

// Green Crystal - Bullet
actor DRPGCrystalGreen : DRPGCrystalBase 19990
{
    DamageFactor "Bullet", 0
    
    Tag "Green Crystal"
    
    States
    {
    Spawn:
        CRYS A 0 ACS_NamedExecuteAlways("MonsterInit", 0, MF_NOAURA | MF_NODROPS)
        CRYS A 4 A_Look
        Loop
    See:
        CRYS A 0 ACS_NamedExecuteAlways("MonsterInit", 0, MF_NOAURA | MF_NODROPS)
        TNT1 A 0 A_SpawnItemEx("DRPGCrystalTrailGreen", 0, 0, 0, 0, 0, 0, 0, SXF_NOCHECKPOSITION)
        CRYS A 2 A_Chase
        Loop
    Death:
        CRYS A 1 A_FadeOut(0.05, true)
        Loop
    }
}

// Yellow Crystal - Melee
actor DRPGCrystalYellow : DRPGCrystalBase 19991
{
    DamageFactor "Melee", 0
    
    Tag "Yellow Crystal"
    
    States
    {
    Spawn:
        CRYS B 0 ACS_NamedExecuteAlways("MonsterInit", 0, MF_NOAURA | MF_NODROPS)
        CRYS B 4 A_Look
        Loop
    See:
        CRYS B 0 ACS_NamedExecuteAlways("MonsterInit", 0, MF_NOAURA | MF_NODROPS)
        TNT1 A 0 A_SpawnItemEx("DRPGCrystalTrailYellow", 0, 0, 0, 0, 0, 0, 0, SXF_NOCHECKPOSITION)
        CRYS B 2 A_Chase
        Loop
    Death:
        CRYS B 1 A_FadeOut(0.05, true)
        Loop
    }
}

// Red Crystal - Fire
actor DRPGCrystalRed : DRPGCrystalBase 19992
{
    DamageFactor "Fire", 0
    
    Tag "Red Crystal"
    
    States
    {
    Spawn:
        CRYS C 0 ACS_NamedExecuteAlways("MonsterInit", 0, MF_NOAURA | MF_NODROPS)
        CRYS C 4 A_Look
        Loop
    See:
        CRYS C 0 ACS_NamedExecuteAlways("MonsterInit", 0, MF_NOAURA | MF_NODROPS)
        TNT1 A 0 A_SpawnItemEx("DRPGCrystalTrailRed", 0, 0, 0, 0, 0, 0, 0, SXF_NOCHECKPOSITION)
        CRYS C 2 A_Chase
        Loop
    Death:
        CRYS C 1 A_FadeOut(0.05, true)
        Loop
    }
}

// Blue Crystal - Plasma
actor DRPGCrystalBlue : DRPGCrystalBase 19993
{
    DamageFactor "Plasma", 0
    
    Tag "Blue Crystal"
    
    States
    {
    Spawn:
        CRYS D 0 ACS_NamedExecuteAlways("MonsterInit", 0, MF_NOAURA | MF_NODROPS)
        CRYS D 4 A_Look
        Loop
    See:
        CRYS D 0 ACS_NamedExecuteAlways("MonsterInit", 0, MF_NOAURA | MF_NODROPS)
        TNT1 A 0 A_SpawnItemEx("DRPGCrystalTrailBlue", 0, 0, 0, 0, 0, 0, 0, SXF_NOCHECKPOSITION)
        CRYS D 2 A_Chase
        Loop
    Death:
        CRYS D 1 A_FadeOut(0.05, true)
        Loop
    }
}

// Crystal Trails
actor DRPGCrystalTrailBase
{
    RenderStyle Add
    
    +NOCLIP
    +NOBLOCKMAP
    +NOGRAVITY
}

actor DRPGCrystalTrailGreen : DRPGCrystalTrailBase
{
    States
    {
    Spawn:
        CRYS A 1 Bright A_FadeOut(0.1, true)
        Loop
    }
}

actor DRPGCrystalTrailYellow : DRPGCrystalTrailBase
{
    States
    {
    Spawn:
        CRYS B 1 Bright A_FadeOut(0.1, true)
        Loop
    }
}

actor DRPGCrystalTrailRed : DRPGCrystalTrailBase
{
    States
    {
    Spawn:
        CRYS C 1 Bright A_FadeOut(0.1, true)
        Loop
    }
}

actor DRPGCrystalTrailBlue : DRPGCrystalTrailBase
{
    States
    {
    Spawn:
        CRYS D 1 Bright A_FadeOut(0.1, true)
        Loop
    }
}
